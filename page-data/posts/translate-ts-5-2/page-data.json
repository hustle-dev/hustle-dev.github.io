{"componentChunkName":"component---src-templates-post-tsx","path":"/posts/translate-ts-5-2/","result":{"data":{"markdownRemark":{"html":"<!-- 썸네일 -->\n<!-- 본문 -->\n<blockquote>\n<p>원글 링크: <a href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-5-2/\">https://devblogs.microsoft.com/typescript/announcing-typescript-5-2/</a></p>\n</blockquote>\n<h2 id=\"using-선언-및-명시적-리소스-관리-사용\"><code class=\"language-text\">using</code> 선언 및 명시적 리소스 관리 사용</h2>\n<p>TS 5.2에는 곧 출시될 ECMAScript의 명시적 리소스 관리 기능이 추가된다. 이 기능이 나오게 된 원인과 사용이점을 이해해보자.</p>\n<p>객체를 생성한 후 일종의 '정리(클린업)'를 해야 하는 경우가 있다. 예를 들어 네트워크 연결을 닫거나 임시 파일을 삭제하거나 메모리를 확보해야 하는 것이다.</p>\n<p>임시 파일을 생성하고 읽고 쓴 파일을 닫은 뒤, 삭제하는 함수를 상상해보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> fs <span class=\"token keyword\">from</span> <span class=\"token string\">\"fs\"</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">doSomeWork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token string\">\".some_temp_file\"</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">openSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// use file...</span>\r\n\r\n    <span class=\"token comment\">// Close the file and delete it.</span>\r\n    fs<span class=\"token punctuation\">.</span><span class=\"token function\">closeSync</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    fs<span class=\"token punctuation\">.</span><span class=\"token function\">unlinkSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>조기 종료가 필요한 경우는 어떻게 될까?</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">doSomeWork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token string\">\".some_temp_file\"</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">openSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// use file...</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">someCondition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// do some more work...</span>\r\n\r\n        <span class=\"token comment\">// Close the file and delete it.</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">closeSync</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">unlinkSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// Close the file and delete it.</span>\r\n    fs<span class=\"token punctuation\">.</span><span class=\"token function\">closeSync</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    fs<span class=\"token punctuation\">.</span><span class=\"token function\">unlinkSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>잊어버리기 쉬운 clean-up(클린업)이 일부 중복되기 시작했다. 또한 오류가 발생하면 파일을 닫고 삭제한다는 보장도 없다. 이 모든 것을 <code class=\"language-text\">try/finally</code> 블록으로 감싸면 이 문제를 해결할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">doSomeWork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token string\">\".some_temp_file\"</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">openSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// use file...</span>\r\n\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">someCondition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token comment\">// do some more work...</span>\r\n            <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// Close the file and delete it.</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">closeSync</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">unlinkSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 방법은 더 강력하지만 코드에 상당한 '노이즈'가 추가된다. <code class=\"language-text\">finally</code> 블록에 더 많은 clean-up(클린업) 로직을 추가하기 시작하면 다른 리소스를 처리하지 못하게 하는 예외와 같은 다른 발목을 잡는 문제도 발생할 수 있다. <a href=\"https://github.com/tc39/proposal-explicit-resource-management\">명시적 리소스 관리</a> 제안이 해결하고자 하는 것이 바로 이 문제이다. 제안의 핵심 아이디어는 처리하려고 하는 clean-up(클린업)을 자바스크립트에서 first class 아이디어로 지원하는 것이다.</p>\n<p>이 작업은 <code class=\"language-text\">Symbol.dispose</code>라는 새로운 내장 <code class=\"language-text\">symbol</code>을 추가하는 것으로 시작되며, <code class=\"language-text\">Symbol.dispose</code> 메서드를 가진 객체를 생성할 수 있다. 편의를 위해 TypeScript는 이를 설명하는 <code class=\"language-text\">Disposable</code>이라는 새로운 전역 타입을 정의한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TempFile</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Disposable</span> <span class=\"token punctuation\">{</span>\r\n    #path<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\r\n    #handle<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>path<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#path <span class=\"token operator\">=</span> path<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#handle <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">openSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// other methods</span>\r\n\r\n    <span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>dispose<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// Close the file and delete it.</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">closeSync</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#handle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">unlinkSync</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>나중에 해당 메서드(<code class=\"language-text\">[Symbol.dispose]</code>)를 호출할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">doSomeWork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TempFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".some_temp_file\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// ...</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\r\n        file<span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>dispose<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>clean-up 로직을 <code class=\"language-text\">TempFile</code> 자체로 옮긴다고 해서 크게 얻을 수 있는 것은 없다. 기본적으로 <code class=\"language-text\">finally</code> 블록의 모든 clean-up을 메서드로 옮긴 것일 뿐이며, 이는 항상 가능했다. 하지만 이 메서드에 잘 알려진 '이름'이 있다는 것은 자바스크립트가 그 위에 다른 기능을 구축할 수 있다는 것을 의미한다.</p>\n<p>이 기능의 첫 번째 주인공은 바로 <code class=\"language-text\">using</code> 선언이다! <code class=\"language-text\">using</code> 선언은 <code class=\"language-text\">const</code>처럼 새로운 고정 바인딩을 선언할 수 있는 새로운 키워드다. 가장 큰 차이점은 <code class=\"language-text\">using</code>으로 선언된 변수는 스코프가 끝날 때 <code class=\"language-text\">Symbol.dispose</code> 메서드가 호출된다는 점이다!</p>\n<p>따라서 코드를 다음과 같이 간단하게 작성할 수 있다</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">doSomeWork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    using file <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TempFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".some_temp_file\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// use file...</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">someCondition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// do some more work...</span>\r\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>전과 비교해보면 <code class=\"language-text\">try/finally</code> 블록이 없다. 기능적으로는 <code class=\"language-text\">using</code> 선언을 사용하면 바로 이 작업을 수행할 수 있지만, 굳이 그렇게 할 필요는 없다.</p>\n<p>C#에서 <code class=\"language-text\">using</code> 선언을 사용하거나 Python에서 <code class=\"language-text\">with</code> 문을 사용하거나 Java에서 <code class=\"language-text\">try</code>-with-resource 선언을 사용하는 데 익숙할 수 있다. 이들은 모두 JavaScript의 새로운 <code class=\"language-text\">using</code> 키워드와 유사하며, 스코프 끝에서 객체의 \"분해\"를 수행하는 유사한 명시적 방법을 제공한다.</p>\n<p><code class=\"language-text\">using</code> 선언을 사용하면 containing scope의 맨 끝 또는 <code class=\"language-text\">return</code>이나 <code class=\"language-text\">throw Error</code>와 같은 \"조기 반환\" 직전에 이러한 clean-up을 수행한다. 또한 스택처럼 선입선출 순서로 처리한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Disposable <span class=\"token punctuation\">{</span>\r\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Creating </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>dispose<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Disposing </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    using a <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    using b <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"b\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">{</span>\r\n        using c <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        using d <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    using e <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"e\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// Unreachable.</span>\r\n    <span class=\"token comment\">// Never created, never disposed.</span>\r\n    using f <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"f\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// Creating a</span>\r\n<span class=\"token comment\">// Creating b</span>\r\n<span class=\"token comment\">// Creating c</span>\r\n<span class=\"token comment\">// Creating d</span>\r\n<span class=\"token comment\">// Disposing d</span>\r\n<span class=\"token comment\">// Disposing c</span>\r\n<span class=\"token comment\">// Creating e</span>\r\n<span class=\"token comment\">// Disposing e</span>\r\n<span class=\"token comment\">// Disposing b</span>\r\n<span class=\"token comment\">// Disposing a</span></code></pre></div>\n<p><code class=\"language-text\">using</code> 선언을 사용하는 함수는 예외에 탄력적이어야 하며, 에러가 발생하면 처분 후 다시 던져진다. 반면에 함수 본문은 예상대로 실행될 수 있지만 <code class=\"language-text\">Symbol.dispose</code>가 <code class=\"language-text\">throw</code>될 수 있다. 이 경우 해당 예외도 다시 발생한다.</p>\n<p>하지만 처분 전후의 로직이 모두 오류를 발생시키면 어떻게 될까? 이러한 경우를 위해 <code class=\"language-text\">SuppressedError</code>가 <code class=\"language-text\">Error</code>의 새로운 하위 타입으로 도입되었다. 마지막으로 던져진 에러를 보관하는 <code class=\"language-text\">suppressed</code> 프로퍼티와 가장 최근에 던져진 에러에 대한 <code class=\"language-text\">error</code> 프로퍼티가 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ErrorA</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Error</span> <span class=\"token punctuation\">{</span>\r\n    name <span class=\"token operator\">=</span> <span class=\"token string\">\"ErrorA\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ErrorB</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Error</span> <span class=\"token punctuation\">{</span>\r\n    name <span class=\"token operator\">=</span> <span class=\"token string\">\"ErrorB\"</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">throwy</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>dispose<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ErrorA</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error from </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    using a <span class=\"token operator\">=</span> <span class=\"token function\">throwy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ErrorB</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"oops!\"</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// SuppressedError</span>\r\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// An error was suppressed during disposal.</span>\r\n\r\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ErrorA</span>\r\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Error from a</span>\r\n\r\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>suppressed<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ErrorB</span>\r\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>suppressed<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// oops!</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>예제에서 동기 메서드를 사용하고 있다는 것을 눈치챘을 것이다. 하지만 많은 리소스 처리는 비동기 작업과 관련이 있으며, 다른 코드를 계속 실행하기 전에 해당 작업이 완료될 때까지 기다려야 한다.</p>\n<p>그렇기 때문에 새로운 <code class=\"language-text\">Symbol.asyncDispose</code>가 있으며, <code class=\"language-text\">await using</code> 선언을 사용하여 대기하는 다음 단계로 넘어간다. <code class=\"language-text\">using</code> 선언을 사용하는 것과 비슷하지만, 핵심은 누구의 처분을 <code class=\"language-text\">await</code> 하는지 조회한다는 것이다. 이 메서드들은 <code class=\"language-text\">Symbol.asyncDispose</code>라는 다른 메서드를 사용하지만, <code class=\"language-text\">Symbol.dispose</code>가 있는 모든 것에 대해 작동할 수 있다. 편의를 위해 TypeScript는 비동기 처분 메서드가 있는 모든 객체를 설명하는 <code class=\"language-text\">AsyncDisposable</code>이라는 전역 타입도 도입했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">doWork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// Do fake work for half a second.</span>\r\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token builtin\">Promise</span></span><span class=\"token punctuation\">(</span>resolve <span class=\"token operator\">=></span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> AsyncDisposable <span class=\"token punctuation\">{</span>\r\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Constructing </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\r\n        async <span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>asyncDispose<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Disposing (async) </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">await</span> <span class=\"token function\">doWork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">await</span> using a <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">await</span> using b <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"b\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">await</span> using c <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"c\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">await</span> using d <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"d\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">await</span> using e <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"e\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// Unreachable.</span>\r\n    <span class=\"token comment\">// Never created, never disposed.</span>\r\n    <span class=\"token keyword\">await</span> using f <span class=\"token operator\">=</span> <span class=\"token function\">loggy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"f\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">func</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// Constructing a</span>\r\n<span class=\"token comment\">// Constructing b</span>\r\n<span class=\"token comment\">// Constructing c</span>\r\n<span class=\"token comment\">// Constructing d</span>\r\n<span class=\"token comment\">// Disposing (async) d</span>\r\n<span class=\"token comment\">// Disposing (async) c</span>\r\n<span class=\"token comment\">// Constructing e</span>\r\n<span class=\"token comment\">// Disposing (async) e</span>\r\n<span class=\"token comment\">// Disposing (async) b</span>\r\n<span class=\"token comment\">// Disposing (async) a</span></code></pre></div>\n<p>다른 사람이 일관되게 해체 로직을 수행할 것으로 예상되는 경우 <code class=\"language-text\">Disposable</code> 및 <code class=\"language-text\">AsyncDisposable</code>로 타입을 정의하면 코드를 훨씬 쉽게 작업할 수 있다. 실제로 <code class=\"language-text\">dispose()</code> 또는 <code class=\"language-text\">close()</code> 메서드가 있는 기존 타입이 많이 존재한다. 예를 들어 Visual Studio Code API는 자체 <code class=\"language-text\">Disposable</code> 인터페이스를 정의하기도 한다. 브라우저와 Node.js, Deno, Bun과 같은 런타임의 API도 파일 핸들, 연결 등과 같이 이미 정리 메서드가 있는 객체에 대해 <code class=\"language-text\">Symbol.dispose</code> 및 <code class=\"language-text\">Symbol.asyncDispose</code>를 사용하도록 선택할 수 있다.</p>\n<p>라이브러리에서는 이 모든 것이 훌륭하게 들릴지 모르지만 시나리오에서는 약간 무거울 수 있다. 임시 clean-up을 많이 하는 경우 새로운 타입을 만들면 지나치게 추상화되고 모범 사례에 대한 의문이 생길 수 있다. 예를 들어 <code class=\"language-text\">TempFile</code>의 예를 다시 살펴보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TempFile</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Disposable</span> <span class=\"token punctuation\">{</span>\r\n    #path<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\r\n    #handle<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>path<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#path <span class=\"token operator\">=</span> path<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#handle <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">openSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// other methods</span>\r\n\r\n    <span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>dispose<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// Close the file and delete it.</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">closeSync</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#handle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">unlinkSync</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>#path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">doSomeWork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    using file <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TempFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".some_temp_file\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// use file...</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">someCondition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// do some more work...</span>\r\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>두 개의 함수를 호출하는 것만 기억하면 되지만, 이것이 최선의 작성 방법일까? 생성자에서 <code class=\"language-text\">openSync</code>를 호출해야 할까, 아니면 <code class=\"language-text\">open()</code> 메서드를 만들어야 할까, 아니면 핸들을 직접 전달해야 할까? 수행해야 하는 모든 가능한 연산에 대해 메서드를 노출해야 할까, 아니면 프로퍼티만 공개해야 할까?</p>\n<p>이제 이 기능의 마지막 스타를 소개한다. <code class=\"language-text\">DisposableStack</code>과 <code class=\"language-text\">AsyncDisposableStack</code>이다. 이 객체들은 일회성 및 많은 clean-up을 수행하는 데 유용하다. <code class=\"language-text\">DisposableStack</code>은 <code class=\"language-text\">Disposable</code> 객체를 추적하는 여러 메서드가 있는 객체로, 임의의 정리 작업을 수행하기 위한 함수를 지정할 수 있다. 또한 <code class=\"language-text\">using</code> 변수를 사용해 할당할 수도 있는데, 이것도 <code class=\"language-text\">Disposable</code>이기 때문이다! 원래 예제를 이렇게 작성할 수 있을 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span> <span class=\"token function\">doSomeWork</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token string\">\".some_temp_file\"</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> file <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">openSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w+\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    using cleanup <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DisposableStack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    cleanup<span class=\"token punctuation\">.</span><span class=\"token function\">defer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">closeSync</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fs<span class=\"token punctuation\">.</span><span class=\"token function\">unlinkSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// use file...</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">someCondition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// do some more work...</span>\r\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// ...</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 <code class=\"language-text\">defer()</code> 메서드는 콜백을 받기만 하며, 이 콜백은 <code class=\"language-text\">cleanup</code>이 처리되면 실행된다. 일반적으로 <code class=\"language-text\">defer</code>(<code class=\"language-text\">use</code> 및 <code class=\"language-text\">adopt</code>와 같은 <code class=\"language-text\">DisposableStack</code> 메서드)는 리소스를 생성한 직후에 호출해야 한다. 이름에서 알 수 있듯이 <code class=\"language-text\">DisposableStack</code>은 스택처럼 추적하는 모든 것을 선입선출 순서로 폐기하므로 값을 생성한 직후에 defer를 호출하면 이상한 종속성 문제를 피할 수 있다. <code class=\"language-text\">AsyncDisposableStack</code>은 비슷하게 작동하지만 <code class=\"language-text\">async</code> 함수와 <code class=\"language-text\">AsyncDisposable</code>s을 추적할 수 있으며, 그 자체로 <code class=\"language-text\">AsyncDisposable</code>이다.</p>\n<p><code class=\"language-text\">defer</code> 메서드는 Go, Swift, Zig, Odin 등의 <code class=\"language-text\">defer</code> 키워드와 여러 가지 면에서 유사하며, 규칙도 비슷해야한다.</p>\n<p>이 기능은 최신 기능이기 때문에 대부분의 런타임에서 기본적으로 지원하지 않는다. 이 기능을 사용하려면 다음에 대한 런타임 폴리필이 필요하다.</p>\n<ul>\n<li><code class=\"language-text\">Symbol.dispose</code></li>\n<li><code class=\"language-text\">Symbol.asyncDispose</code></li>\n<li><code class=\"language-text\">DisposableStack</code></li>\n<li><code class=\"language-text\">AsyncDisposableStack</code></li>\n<li><code class=\"language-text\">SuppressedError</code></li>\n</ul>\n<p>그러나 <code class=\"language-text\">using</code>과 <code class=\"language-text\">await using</code>에만 관심이 있다면 내장된 <code class=\"language-text\">symbol</code>을 폴리필링하는 것만으로도 충분할 것이다. 대부분의 경우 다음과 같은 간단한 방법으로 해결할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\">Symbol<span class=\"token punctuation\">.</span>dispose <span class=\"token operator\">??=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Symbol.dispose\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nSymbol<span class=\"token punctuation\">.</span>asyncDispose <span class=\"token operator\">??=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Symbol.asyncDispose\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>또한 컴파일 <code class=\"language-text\">target</code>을 <code class=\"language-text\">es2022</code> 이하로 설정하고 <code class=\"language-text\">lib</code> 설정에 <code class=\"language-text\">\"esnext\"</code> 또는 <code class=\"language-text\">\"esnext.disposable\"</code>을 포함하도록 구성해야한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token punctuation\">{</span>\r\n    <span class=\"token string-property property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token string-property property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es2022\"</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string-property property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"es2022\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"esnext.disposable\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dom\"</span><span class=\"token punctuation\">]</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"decorator-metadata\">Decorator Metadata</h2>\n<p>타입스크립트 5.2는 데코레이터 메타데이터라는 곧 출시될 ECMAScript 기능을 구현한다.</p>\n<p>이 기능의 핵심 아이디어는 데코레이터가 사용하는 클래스 또는 그 안에서 메타데이터를 쉽게 생성하고 사용할 수 있도록 하는 것이다.</p>\n<p>이제 데코레이터 함수를 사용할 때마다 컨텍스트 객체의 새 <code class=\"language-text\">metadata</code> 프로퍼티에 액세스할 수 있다. <code class=\"language-text\">metadata</code> 프로퍼티는 단순한 객체만 보유한다. 자바스크립트에서는 프로퍼티를 임의로 추가할 수 있으므로 각 데코레이터가 업데이트하는 사전으로 사용할 수 있다. 또는 클래스의 각 데코레이션 부분에 대해 모든 <code class=\"language-text\">metadata</code> 객체가 동일하므로 이를 <code class=\"language-text\">Map</code>의 키로 사용할 수 있다. 클래스에 있는 모든 데코레이터가 실행되면 해당 오브젝트는 <code class=\"language-text\">Symbol.metadata</code>를 통해 클래스에서 액세스할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Context</span> <span class=\"token punctuation\">{</span>\r\n    name<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\r\n    metadata<span class=\"token operator\">:</span> Record<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">setMetadata</span><span class=\"token punctuation\">(</span>_target<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> context<span class=\"token operator\">:</span> Context<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    context<span class=\"token punctuation\">.</span>metadata<span class=\"token punctuation\">[</span>context<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">SomeClass</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">setMetadata</span></span>\r\n    foo <span class=\"token operator\">=</span> <span class=\"token number\">123</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">setMetadata</span></span>\r\n    accessor bar <span class=\"token operator\">=</span> <span class=\"token string\">\"hello!\"</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">setMetadata</span></span>\r\n    <span class=\"token function\">baz</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">const</span> ourMetadata <span class=\"token operator\">=</span> SomeClass<span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>metadata<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>ourMetadata<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// { \"bar\": true, \"baz\": true, \"foo\": true }</span></code></pre></div>\n<p>이는 여러 가지 시나리오에서 유용할 수 있다. 디버깅, 직렬화, 데코레이터를 사용한 의존성 주입 등 다양한 용도로 메타데이터를 첨부할 수 있다. 메타데이터 객체는 데코레이터가 적용된 클래스별로 생성되므로 프레임워크는 메타데이터 객체를 <code class=\"language-text\">Map</code> 또는 <code class=\"language-text\">WeakMap</code>의 키로 비공개로 사용하거나 필요에 따라 프로퍼티를 붙일 수 있다.</p>\n<p>예를 들어, <code class=\"language-text\">JSON.stringify</code>를 다음과 같이 사용할 때 어떤 프로퍼티와 접근자가 직렬화 가능한지 추적하기 위해 데코레이터를 사용한다고 가정해 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> serialize<span class=\"token punctuation\">,</span> jsonify <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./serializer\"</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Person</span> <span class=\"token punctuation\">{</span>\r\n    firstName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\r\n    lastName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">serialize</span></span>\r\n    age<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\r\n\r\n    <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">serialize</span></span>\r\n    <span class=\"token keyword\">get</span> <span class=\"token function\">fullName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>firstName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lastName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token function\">jsonify</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>firstName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> lastName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> age<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// ...</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 의도는 <code class=\"language-text\">age</code>와 <code class=\"language-text\">fullName</code>만 직렬화해야 한다는 것인데, 이는 <code class=\"language-text\">@serialize</code> 데코레이터로 표시되어 있기 때문이다. 이를 위해 <code class=\"language-text\">toJSON</code> 메서드를 정의하지만, <code class=\"language-text\">@serialize</code>가 생성한 메타데이터를 사용하는 <code class=\"language-text\">jsonify</code>를 호출할 뿐이다.</p>\n<p>다음은 <code class=\"language-text\">./serialize.ts</code> 모듈이 어떻게 정의되는지에 대한 예시이다:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> serializables <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Context</span> <span class=\"token operator\">=</span>\r\n    <span class=\"token operator\">|</span> ClassAccessorDecoratorContext\r\n    <span class=\"token operator\">|</span> ClassGetterDecoratorContext\r\n    <span class=\"token operator\">|</span> ClassFieldDecoratorContext\r\n    <span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span>_target<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> context<span class=\"token operator\">:</span> Context<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>static <span class=\"token operator\">||</span> context<span class=\"token punctuation\">.</span>private<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Can only serialize public instance members.\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> context<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> <span class=\"token string\">\"symbol\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cannot serialize symbol-named properties.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">const</span> propNames <span class=\"token operator\">=</span>\r\n        <span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>metadata<span class=\"token punctuation\">[</span>serializables<span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">??=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    propNames<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">jsonify</span><span class=\"token punctuation\">(</span>instance<span class=\"token operator\">:</span> object<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> metadata <span class=\"token operator\">=</span> instance<span class=\"token punctuation\">.</span>constructor<span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>metadata<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> propNames <span class=\"token operator\">=</span> metadata<span class=\"token operator\">?.</span><span class=\"token punctuation\">[</span>serializables<span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>propNames<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No members marked with @serialize.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">const</span> pairStrings <span class=\"token operator\">=</span> propNames<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>key <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> strKey <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">const</span> strValue <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>instance <span class=\"token keyword\">as</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>strKey<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>strValue<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">{ </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pairStrings<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">\", \"</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> }</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 모듈에는 <code class=\"language-text\">@serializable</code>로 표시된 프로퍼티의 이름을 저장하고 검색하기 위해 <code class=\"language-text\">serializables</code>라는 로컬 <code class=\"language-text\">symbol</code>이 있다. 이 모듈은 <code class=\"language-text\">@serializable</code>을 호출할 때마다 메타데이터에 이러한 프로퍼티 이름 목록을 저장한다. <code class=\"language-text\">jsonify</code>가 호출되면 메타데이터에서 속성 목록을 가져와 인스턴스에서 실제 값을 검색하는 데 사용되며, 결국 해당 이름과 값을 직렬화한다.</p>\n<p><code class=\"language-text\">symbol</code>을 사용하면 기술적으로 다른 사람이 이 데이터에 액세스할 수 있다. 메타데이터 객체를 키로 사용하는 <code class=\"language-text\">WeakMap</code>을 사용하는 것도 대안이 될 수 있다. 이 경우 데이터를 비공개로 유지하고 타입 단언을 더 적게 사용하지만 그 외에는 비슷하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> serializables <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WeakMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Context</span> <span class=\"token operator\">=</span>\r\n    <span class=\"token operator\">|</span> ClassAccessorDecoratorContext\r\n    <span class=\"token operator\">|</span> ClassGetterDecoratorContext\r\n    <span class=\"token operator\">|</span> ClassFieldDecoratorContext\r\n    <span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span>_target<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> context<span class=\"token operator\">:</span> Context<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>static <span class=\"token operator\">||</span> context<span class=\"token punctuation\">.</span>private<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Can only serialize public instance members.\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> context<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> <span class=\"token string\">\"string\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Can only serialize string properties.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">let</span> propNames <span class=\"token operator\">=</span> serializables<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>metadata<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>propNames <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        serializables<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>metadata<span class=\"token punctuation\">,</span> propNames <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    propNames<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">jsonify</span><span class=\"token punctuation\">(</span>instance<span class=\"token operator\">:</span> object<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> metadata <span class=\"token operator\">=</span> instance<span class=\"token punctuation\">.</span>constructor<span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>metadata<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> propNames <span class=\"token operator\">=</span> metadata <span class=\"token operator\">&amp;&amp;</span> serializables<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>metadata<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>propNames<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No members marked with @serialize.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">const</span> pairStrings <span class=\"token operator\">=</span> propNames<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>key <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> strKey <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">const</span> strValue <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>instance <span class=\"token keyword\">as</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>strKey<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>strValue<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">{ </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pairStrings<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">\", \"</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> }</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>참고로, 이러한 구현은 서브클래싱과 상속을 처리하지 않는다. 이는 자신의 몫이다.(그리고 어떤 버전의 파일이 다른 버전보다 더 쉽다는 것을 알게 될 수도 있다!).</p>\n<p>이 기능은 아직 새 기능이기 때문에 대부분의 런타임은 기본적으로 지원하지 않는다. 이 기능을 사용하려면 Symbol.metadata에 대한 폴리필이 필요하다. 대부분의 경우 다음과 같은 간단한 방법으로 해결할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\">Symbol<span class=\"token punctuation\">.</span>metadata <span class=\"token operator\">??=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Symbol.metadata\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>또한 컴파일 대상을 <code class=\"language-text\">es2022</code> 이하로 설정하고 라이브러리 설정에 <code class=\"language-text\">\"esnext\"</code> 또는 <code class=\"language-text\">\"esnext.decorators\"</code>를 포함하도록 구성해야 한다.</p>\n<h2 id=\"명명된-요소-및-익명-튜플-요소\">명명된 요소 및 익명 튜플 요소</h2>\n<p>튜플 타입은 각 요소에 대해 선택적 레이블 또는 이름을 지원한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">Pair</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>first<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> second<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이러한 레이블은 가독성과 툴링에 도움을 주기 위한 것일 뿐, 레이블로 허용되는 작업을 변경하는 것은 아니다.</p>\n<p>하지만 이전에는 튜플에 레이블이 있는 요소와 레이블이 없는 요소를 섞어서 사용할 수 없다는 규칙이 있었다. 즉, 어떤 요소도 튜플에 레이블을 가질 수 없거나 모든 요소에 레이블이 필요했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// ✅ fine - no labels</span>\r\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Pair1</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// ✅ fine - all fully labeled</span>\r\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Pair2</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>first<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> second<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// ❌ previously an error</span>\r\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Pair3</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>first<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">//                         ~</span>\r\n<span class=\"token comment\">// Tuple members must all have names</span>\r\n<span class=\"token comment\">// or all not have names.</span></code></pre></div>\n<p><code class=\"language-text\">rest</code> 또는 <code class=\"language-text\">tail</code>과 같은 레이블을 추가해야하는 나머지 요소들의 경우 이는 성가신 일이 될 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// ❌ previously an error</span>\r\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TwoOrMore_A</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>first<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> second<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span><span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">//                                          ~~~~~~</span>\r\n<span class=\"token comment\">// Tuple members must all have names</span>\r\n<span class=\"token comment\">// or all not have names.</span>\r\n\r\n<span class=\"token comment\">// ✅</span>\r\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">TwoOrMore_B</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>first<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> second<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> rest<span class=\"token operator\">:</span> <span class=\"token operator\">...</span><span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>또한 이 제한은 타입 시스템 내부에서 적용되어야 했기 때문에 TypeScript가 레이블을 잃게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">HasLabels</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>a<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">HasNoLabels</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Merged</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>HasNoLabels<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>HasLabels<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">//   ^ [number, number, string, string]</span>\r\n<span class=\"token comment\">//</span>\r\n<span class=\"token comment\">//     'a' and 'b' were lost in 'Merged'</span></code></pre></div>\n<p>TypeScript 5.2에서는 튜플 레이블에 대한 제한이 해제되었다. 이제 레이블이 없는 튜플로 스프레드할 때 레이블을 보존할 수도 있다.</p>\n<h2 id=\"배열의-유니온에-더-쉬운-메서드-사용\">배열의 유니온에 더 쉬운 메서드 사용</h2>\n<p>이전 버전의 TypeScript에서는 배열의 유니온에서 메서드를 호출하는 것이 어려웠다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">declare</span> <span class=\"token keyword\">let</span> array<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\narray<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">=></span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">//    ~~~~~~ error!</span>\r\n<span class=\"token comment\">// This expression is not callable.</span>\r\n<span class=\"token comment\">//   Each member of the union type '...' has signatures,</span>\r\n<span class=\"token comment\">//   but none of those signatures are compatible</span>\r\n<span class=\"token comment\">//   with each other.</span></code></pre></div>\n<p>이 예제에서 TypeScript는 <code class=\"language-text\">string[]</code> 및 <code class=\"language-text\">number[]</code>에서 각 버전의 <code class=\"language-text\">filter</code>가 호환되는지 확인하려고 시도한다. 일관된 전략이 없으면 TypeScript는 허공에 손을 던지고 \"작동하게 만들 수 없습니다\"라고 말한다.</p>\n<p>TypeScript 5.2에서는 이러한 경우 포기하기 전에 배열의 공용체를 특수한 경우로 취급한다. 각 멤버의 요소 타입으로 새로운 배열 타입을 구성한 다음 그 배열에 메서드를 호출한다.</p>\n<p>예를 들어 위의 <code class=\"language-text\">string[] | number[]</code>는 <code class=\"language-text\">(문자열 | 숫자)[]</code>(또는 <code class=\"language-text\">Array&lt;string | number></code>)로 변환되고 해당 타입에 대해 <code class=\"language-text\">filter</code>가 호출된다. 필터가 <code class=\"language-text\">string[] | number[]</code> 대신 <code class=\"language-text\">Array&lt;string | number></code>를 생성한다는 약간의 주의 사항이 있지만, 새로 생성된 값의 경우 \"잘못된\" 문제가 발생할 위험이 적다.</p>\n<p>즉, <code class=\"language-text\">filter</code>, <code class=\"language-text\">find</code>, <code class=\"language-text\">some</code>, <code class=\"language-text\">every</code>, <code class=\"language-text\">reduce</code>와 같은 많은 메서드가 이전에는 사용할 수 없었던 배열의 조합에 대해 모두 호출할 수 있어야 한다.</p>\n<h2 id=\"배열-메서드-복사\">배열 메서드 복사</h2>\n<p>TypeScript 5.2에는 \"복사하여 배열 변경\" 제안에서 ECMAScript에 추가된 메서드에 대한 정의가 포함되어 있다.</p>\n<p>자바스크립트의 배열에는 이미 <code class=\"language-text\">sort()</code>, <code class=\"language-text\">splice()</code>, <code class=\"language-text\">reverse()</code> 등 몇 가지 유용한 메서드가 있었지만, 이 메서드들은 현재 배열을 업데이트했다. 종종 원본에 영향을 주지 않고 완전히 별도의 배열을 만드는 것이 바람직할 때가 있다. 이를 위해 <code class=\"language-text\">slice()</code> 또는 배열 스프레드(예: <code class=\"language-text\">[...myArray]</code>)를 사용하여 먼저 복사본을 가져온 다음 연산을 수행할 수 있다. 예를 들어, <code class=\"language-text\">myArray.slice().reverse()</code>를 작성하여 반전된 복사본을 얻을 수 있다.</p>\n<p>복사본을 만들되 단일 요소를 변경하는 또 다른 일반적인 경우도 있다. 이를 수행하는 방법에는 여러 가지가 있지만, 가장 확실한 방법은 아래와 같이 여러개의 문으로 된 긴 코드를 작성하는 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> copy <span class=\"token operator\">=</span> myArray<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\ncopy<span class=\"token punctuation\">[</span>someIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> updatedValue<span class=\"token punctuation\">;</span>\r\n<span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span>copy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>또는 아래와 같이 작성할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token function\">doSomething</span><span class=\"token punctuation\">(</span>myArray<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> index <span class=\"token operator\">===</span> someIndex <span class=\"token operator\">?</span> updatedValue <span class=\"token operator\">:</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이 모든 것이 너무 일반적인 연산의 경우 번거롭다. 그래서 자바스크립트에는 이제 동일한 연산을 수행하지만 원본 데이터에 영향을 주지 않는 새로운 메서드 4가지(<code class=\"language-text\">toSorted</code>, <code class=\"language-text\">toSpliced</code>, <code class=\"language-text\">toReversed</code>, <code class=\"language-text\">with</code>)가 추가되었다. 처음 3개의 메서드는 돌연변이 메서드와 동일한 연산을 수행하지만 새 배열을 반환한다. 또한 <code class=\"language-text\">with</code> 메서드는 새 배열을 반환하지만 단일 요소가 업데이트된다(위에서 설명한 대로).</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Mutating</th>\n<th align=\"center\">Copying</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">myArray.reverse()</td>\n<td align=\"center\">myArray.toReversed()</td>\n</tr>\n<tr>\n<td align=\"center\">myArray.sort((a, b) => ...)</td>\n<td align=\"center\">myArray.toSorted((a, b) => ...)</td>\n</tr>\n<tr>\n<td align=\"center\">myArray.splice(start, deleteCount, ...items)</td>\n<td align=\"center\">myArray.toSpliced(start,</td>\n</tr>\n<tr>\n<td align=\"center\">myArray[index] = updatedValue</td>\n<td align=\"center\">myArray.with(index, updatedValue)</td>\n</tr>\n</tbody>\n</table>\n<p>복사 메서드는 항상 새 배열을 생성하는 반면, mutating 연산은 일관성이 없다는 점에 유의하자</p>\n<p>이러한 메서드는 일반 배열에서만 사용할 수 있는 것이 아니라 <code class=\"language-text\">Int32Array</code>, <code class=\"language-text\">Uint8Array</code> 등과 같은 타입 배열에서도 사용할 수 있다.</p>\n<h2 id=\"symbols-as-weakmap-and-weakset-keys\"><code class=\"language-text\">symbol</code>s as <code class=\"language-text\">WeakMap</code> and <code class=\"language-text\">WeakSet</code> Keys</h2>\n<p><code class=\"language-text\">symbol</code>을 <code class=\"language-text\">WeakMap</code> 및 <code class=\"language-text\">WeakSet</code>의 키로 사용할 수 있으며, 이는 ECMAScript 자체에 이 기능이 추가된 것을 반영한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> myWeakMap <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WeakMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> key <span class=\"token operator\">=</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> someObject <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/*...*/</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// Works! ✅</span>\r\nmyWeakMap<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> someObject<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nmyWeakMap<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"typescript-구현-파일-확장자를-가진-타입-전용-가져오기-경로\">TypeScript 구현 파일 확장자를 가진 타입 전용 가져오기 경로</h2>\n<p>TypeScript는 이제 <code class=\"language-text\">allowImportingTsExtensions</code>의 활성화 여부에 관계없이 선언 및 구현 파일 확장명을 모두 타입 전용 가져오기 경로에 포함할 수 있다.</p>\n<p>즉, 이제 <code class=\"language-text\">.ts</code>, <code class=\"language-text\">.mts</code>, <code class=\"language-text\">.cts</code> 및 <code class=\"language-text\">.tsx</code> 파일 확장명을 사용하는 <code class=\"language-text\">import type</code> 문을 작성할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">import</span> <span class=\"token keyword\">type</span> <span class=\"token punctuation\">{</span> JustAType <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"./justTypes.ts\"</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>param<span class=\"token operator\">:</span> JustAType<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// ...</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>또한 JSDoc을 사용하여 TypeScript와 JavaScript 모두에서 사용할 수 있는 <code class=\"language-text\">import()</code> 타입이 해당 파일 확장자를 사용할 수 있음을 의미한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">/**\r\n * @param {import(\"./justTypes.ts\").JustAType} param\r\n */</span>\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// ...</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"객체-멤버의-쉼표-완성\">객체 멤버의 쉼표 완성</h2>\n<p>객체에 새 속성을 추가할 때 쉼표를 추가하는 것을 잊어버리기 쉽다. 이전에는 쉼표를 잊어버리고 자동 완성을 요청하면 TypeScript에서 관련 없는 잘못된 완성 결과가 표시되어 혼란스러웠다.</p>\n<p>이제 TypeScript 5.2에서는 쉼표가 누락된 경우 객체 멤버 완성을 정상적으로 제공한다. 하지만 구문 오류로 표시되는 것을 건너뛰기 위해 누락된 쉼표도 자동으로 삽입한다.</p>\n<img width=\"751\" alt=\"image\" src=\"https://github.com/hustle-dev/hustle-dev.github.io/assets/53992007/d3766590-082b-4929-9d28-e0873c256139\">\n<h2 id=\"인라인-변수-리팩토링\">인라인 변수 리팩토링</h2>\n<p>이제 TypeScript 5.2에는 변수의 내용을 모든 사용 사이트에 인라인 처리하는 리팩터링 기능이 있다.</p>\n<img width=\"748\" alt=\"image\" src=\"https://github.com/hustle-dev/hustle-dev.github.io/assets/53992007/a0e959a0-94f1-405b-8fe2-acb890a2614e\">\n<p>\"인라인 변수\" 리팩터링을 사용하면 변수가 제거되고 변수의 모든 사용처가 해당 이니셜라이저로 대체된다. 이 경우 이니셜라이저의 부작용이 변수가 사용된 횟수만큼 다른 시간에 실행될 수 있다는 점에 유의하자.</p>\n<h2 id=\"클릭-가능한-인레이-매개변수-힌트\">클릭 가능한 인레이 매개변수 힌트</h2>\n<p>인레이 힌트는 매개변수 이름, 추론된 유형 등 코드 내에 존재하지 않는 정보도 한눈에 파악할 수 있게 해준다. TypeScript 5.2에서는 인레이 힌트와 상호 작용할 수 있는 기능이 추가되었다. 예를 들어 Visual Studio 코드 인사이더에서는 이제 인레이 힌트를 클릭하여 매개변수의 정의로 이동할 수 있다.</p>\n<img width=\"748\" alt=\"image\" src=\"https://github.com/hustle-dev/hustle-dev.github.io/assets/53992007/e3b705a8-4949-49f6-98a9-d3fee09dce33\">\n<h2 id=\"지속적인-타입-호환성-확인-최적화\">지속적인 타입 호환성 확인 최적화</h2>\n<p>TypeScript는 구조적 타입 시스템이기 때문에 멤버별로 타입을 비교해야 하는 경우가 있지만 재귀 타입은 여기에 몇 가지 문제가 있다. 예를 들어</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\"><span class=\"token constant\">A</span></span> <span class=\"token punctuation\">{</span>\r\n    value<span class=\"token operator\">:</span> <span class=\"token constant\">A</span><span class=\"token punctuation\">;</span>\r\n    other<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\"><span class=\"token constant\">B</span></span> <span class=\"token punctuation\">{</span>\r\n    value<span class=\"token operator\">:</span> <span class=\"token constant\">B</span><span class=\"token punctuation\">;</span>\r\n    other<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>타입 A가 타입 B와 호환되는지 확인할 때 타입스크립트는 결국 A와 B의 값 타입이 각각 호환되는지 확인하게 된다. 이 시점에서 타입 시스템은 더 이상 확인을 중단하고 다른 멤버를 확인해야 한다. 이를 위해 타입 시스템은 두 타입이 이미 관련되어 있는 경우를 추적해야 한다.</p>\n<p>이전에는 타입스크립트가 이미 타입 쌍의 스택을 보관하고 이를 반복하여 해당 타입이 관련되어 있는지 확인했다. 이 스택이 얕을 때는 문제가 되지 않지만, 스택이 얕지 않을 때는 문제가 된다.</p>\n<p>TypeScript 5.2에서는 간단한 <code class=\"language-text\">Set</code>으로 이 정보를 추적할 수 있다. 이를 통해 드리즐 라이브러리를 사용한 보고된 테스트 케이스에 소요되는 시간이 33% 이상 단축되었다!</p>\n<h2 id=\"변경-사항-및-오류-수정\">변경 사항 및 오류 수정</h2>\n<p>TypeScript는 불필요하게 변경하지 않기 위해 노력하지만, 때로는 코드를 더 잘 분석할 수 있도록 수정하고 개선해야 할 때가 있다.</p>\n<h3 id=\"libdts-changes\"><code class=\"language-text\">lib.d.ts Changes</code></h3>\n<p>DOM용으로 생성된 타입은 코드베이스에 영향을 미칠 수 있다. 자세한 내용은 TypeScript 5.2의 DOM 업데이트를 참조하세요.</p>\n<h3 id=\"labeledelementdeclarations은-undefined-요소를-보유할-수-있음\"><code class=\"language-text\">labeledElementDeclarations</code>은 <code class=\"language-text\">undefined</code> 요소를 보유할 수 있음</h3>\n<p>레이블이 지정된 요소와 레이블이 지정되지 않은 요소의 혼합을 지원하기 위해 TypeScript의 API가 약간 변경되었다. <code class=\"language-text\">TupleType</code>의 <code class=\"language-text\">labeledElementDeclarations</code> 속성은 요소가 레이블이 지정되지 않은 각 위치에 대해 <code class=\"language-text\">undefined</code> 상태로 유지될 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\">  <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TupleType</span> <span class=\"token punctuation\">{</span>\r\n<span class=\"token operator\">-</span>     labeledElementDeclarations<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token keyword\">readonly</span> <span class=\"token punctuation\">(</span>NamedTupleMember <span class=\"token operator\">|</span> ParameterDeclaration<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token operator\">+</span>     labeledElementDeclarations<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token keyword\">readonly</span> <span class=\"token punctuation\">(</span>NamedTupleMember <span class=\"token operator\">|</span> ParameterDeclaration <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"module과-moduleresolution는-최근-nodejs-설정에서-일치해야-한다\"><code class=\"language-text\">module</code>과 <code class=\"language-text\">moduleResolution</code>는 최근 Node.js 설정에서 일치해야 한다.</h3>\n<p><code class=\"language-text\">module</code> 옵션과 <code class=\"language-text\">moduleResolution</code> 옵션은 각각 <code class=\"language-text\">node16</code>과 <code class=\"language-text\">nodenext</code> 설정을 지원한다. 이는 사실상 모든 최신 Node.js 프로젝트에서 사용해야 하는 \"최신 Node.js\" 설정이다. 이 두 옵션이 Node.js 관련 설정을 사용하는지 여부에 대해 일치하지 않으면 프로젝트가 사실상 잘못 구성된다는 사실을 발견했다.</p>\n<p>TypeScript 5.2에서는 <code class=\"language-text\">--module</code> 및 <code class=\"language-text\">--moduleResolution</code> 옵션 중 하나에 <code class=\"language-text\">node16</code> 또는 <code class=\"language-text\">nodenext</code>를 사용하는 경우 이제 다른 옵션에도 유사한 Node.js 관련 설정이 있어야 한다. 설정이 서로 다른 경우 다음과 같은 오류 메시지가 표시될 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\">Option <span class=\"token string\">'moduleResolution'</span> must be <span class=\"token keyword\">set</span> to <span class=\"token string\">'NodeNext'</span> <span class=\"token punctuation\">(</span>or left unspecified<span class=\"token punctuation\">)</span> when option <span class=\"token string\">'module'</span> <span class=\"token keyword\">is</span> <span class=\"token keyword\">set</span> to <span class=\"token string\">'NodeNext'</span><span class=\"token punctuation\">.</span>\r\n\r\n<span class=\"token comment\">// 또는</span>\r\n\r\nOption <span class=\"token string\">'module'</span> must be <span class=\"token keyword\">set</span> to <span class=\"token string\">'Node16'</span> when option <span class=\"token string\">'moduleResolution'</span> <span class=\"token keyword\">is</span> <span class=\"token keyword\">set</span> to <span class=\"token string\">'Node16'</span><span class=\"token punctuation\">.</span></code></pre></div>\n<p>예를 들어 <code class=\"language-text\">--module esnext --muleResolution node16</code>은 거부되지만, <code class=\"language-text\">--module nodenext</code>만 사용하거나 <code class=\"language-text\">--module esnext --muleResolution</code> 번들러를 사용하는 것이 더 나을 수 있다.</p>\n<h3 id=\"병합된-기호에-대한-일관된-export-확인\">병합된 기호에 대한 일관된 export 확인</h3>\n<p>두 선언이 병합되면 두 선언이 모두 내보낼지 여부가 일치해야 한다. 버그로 인해 선언 파일이나 <code class=\"language-text\">declare module</code> 블록과 같은 주변 컨텍스트에서 TypeScript가 특정 경우를 놓쳤다. 예를 들어, 다음과 같이 <code class=\"language-text\">replaceInFile</code>이 내보낸 함수로 한 번 선언되고 내보내지 않은 네임스페이스로 한 번 선언되는 경우에는 오류가 발생하지 않는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">declare</span> <span class=\"token keyword\">module</span> <span class=\"token string\">'replace-in-file'</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">replaceInFile</span><span class=\"token punctuation\">(</span>config<span class=\"token operator\">:</span> <span class=\"token builtin\">unknown</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">export</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">namespace</span> replaceInFile <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">sync</span><span class=\"token punctuation\">(</span>config<span class=\"token operator\">:</span> <span class=\"token builtin\">unknown</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token builtin\">unknown</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>주변 모듈에서 <code class=\"language-text\">export { ... }</code> 또는 <code class=\"language-text\">export default ...</code>와 같은 유사한 구문을 추가하면 모든 선언이 자동으로 내보내지는지 여부가 암시적으로 변경된다. 이제 TypeScript는 안타깝게도 이러한 혼란스러운 의미를 보다 일관되게 인식하고 <code class=\"language-text\">replaceInFile</code>의 모든 선언이 수정자에서 일치해야 한다는 사실에 대해 다음과 같은 오류를 발생시킨다:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\">Individual declarations <span class=\"token keyword\">in</span> merged declaration <span class=\"token string\">'replaceInFile'</span> must be all exported or all local<span class=\"token punctuation\">.</span></code></pre></div>\n<h3 id=\"module-항상-namespace로-방출\"><code class=\"language-text\">module</code> 항상 <code class=\"language-text\">namespace</code>로 방출</h3>\n<p>타입스크립트의 <code class=\"language-text\">namespace</code>는 사실 <code class=\"language-text\">module</code> 키워드를 사용하기 시작했는데, ECMAScript도 같은 용도로 사용할 수 있을 것으로 보였기 때문dl다. 원래는 이를 \"내부 모듈\"이라고 불렀지만 내부 모듈은 결국 자바스크립트에 포함되지 않았다.</p>\n<p>수년 동안(2015년부터 TypeScript 1.5부터!) TypeScript는 혼동을 피하기 위해 <code class=\"language-text\">namespace</code> 키워드를 지원해 왔다. 이를 한 단계 더 발전시켜 TypeScript 5.2에서는 선언 파일을 생성할 때 항상 네임스페이스 키워드를 방출한다. 따라서 다음과 같이 코딩하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">module</span> foo <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>를 실행하면 다음과 같은 선언 파일이 생성된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">declare</span> <span class=\"token keyword\">namespace</span> foo <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">function</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>훨씬 더 오래된 버전의 TypeScript와 호환되지 않을 수 있지만, 그 영향은 제한적일 것으로 예상된다.</p>\n<p>다음과 같은 주변 모듈 선언에 유의하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// UNAFFECTED</span>\r\n<span class=\"token keyword\">declare</span> <span class=\"token keyword\">module</span> <span class=\"token string\">\"some-module-path\"</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// ...</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이는 영향을 받지 않는다.</p>","frontmatter":{"date":"23.08.29","description":"TypeScript 5.2 Release를 번역하면서 어떤 기능들이 나왔는지 학습합니다.","heroImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAn0lEQVR42mOwD9z6n5qYgW4G2gVsgbMdgrb+dwiEYHQ5ogyEabD23fzf0nvTfwvvTXDaymczXA02g3G60NZ/y/+ozP3/43IP/k8tPvw/ufDw/5Tiw/+jsvb/t/HbQrqXQZqCk/f8z6489j+99Mj/+LyD/zPKjv6PyT7w39pvM3letvHb/N/SZ9N/cy+IdynyMkakQDFZkUJIE1kGkpsOAVDDx+dN5GA6AAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/6952768edde771e3e65071afc7efe37d/18b2e/heroImage.png","srcSet":"/static/6952768edde771e3e65071afc7efe37d/a4d46/heroImage.png 175w,\n/static/6952768edde771e3e65071afc7efe37d/d8f52/heroImage.png 350w,\n/static/6952768edde771e3e65071afc7efe37d/18b2e/heroImage.png 700w","sizes":"(min-width: 700px) 700px, 100vw"},"sources":[{"srcSet":"/static/6952768edde771e3e65071afc7efe37d/eac4f/heroImage.webp 175w,\n/static/6952768edde771e3e65071afc7efe37d/a4795/heroImage.webp 350w,\n/static/6952768edde771e3e65071afc7efe37d/377b6/heroImage.webp 700w","type":"image/webp","sizes":"(min-width: 700px) 700px, 100vw"}]},"width":700,"height":350}}},"heroImageAlt":"타입스크립트","tags":["Typescript","번역"],"title":"TypeScript 5.2 번역"},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#using-%EC%84%A0%EC%96%B8-%EB%B0%8F-%EB%AA%85%EC%8B%9C%EC%A0%81-%EB%A6%AC%EC%86%8C%EC%8A%A4-%EA%B4%80%EB%A6%AC-%EC%82%AC%EC%9A%A9\"><code class=\"language-text\">using</code> 선언 및 명시적 리소스 관리 사용</a></p>\n</li>\n<li>\n<p><a href=\"#decorator-metadata\">Decorator Metadata</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%AA%85%EB%AA%85%EB%90%9C-%EC%9A%94%EC%86%8C-%EB%B0%8F-%EC%9D%B5%EB%AA%85-%ED%8A%9C%ED%94%8C-%EC%9A%94%EC%86%8C\">명명된 요소 및 익명 튜플 요소</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%B0%B0%EC%97%B4%EC%9D%98-%EC%9C%A0%EB%8B%88%EC%98%A8%EC%97%90-%EB%8D%94-%EC%89%AC%EC%9A%B4-%EB%A9%94%EC%84%9C%EB%93%9C-%EC%82%AC%EC%9A%A9\">배열의 유니온에 더 쉬운 메서드 사용</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%B0%B0%EC%97%B4-%EB%A9%94%EC%84%9C%EB%93%9C-%EB%B3%B5%EC%82%AC\">배열 메서드 복사</a></p>\n</li>\n<li>\n<p><a href=\"#symbols-as-weakmap-and-weakset-keys\"><code class=\"language-text\">symbol</code>s as <code class=\"language-text\">WeakMap</code> and <code class=\"language-text\">WeakSet</code> Keys</a></p>\n</li>\n<li>\n<p><a href=\"#typescript-%EA%B5%AC%ED%98%84-%ED%8C%8C%EC%9D%BC-%ED%99%95%EC%9E%A5%EC%9E%90%EB%A5%BC-%EA%B0%80%EC%A7%84-%ED%83%80%EC%9E%85-%EC%A0%84%EC%9A%A9-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0-%EA%B2%BD%EB%A1%9C\">TypeScript 구현 파일 확장자를 가진 타입 전용 가져오기 경로</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B0%9D%EC%B2%B4-%EB%A9%A4%EB%B2%84%EC%9D%98-%EC%89%BC%ED%91%9C-%EC%99%84%EC%84%B1\">객체 멤버의 쉼표 완성</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B8%EB%9D%BC%EC%9D%B8-%EB%B3%80%EC%88%98-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81\">인라인 변수 리팩토링</a></p>\n</li>\n<li>\n<p><a href=\"#%ED%81%B4%EB%A6%AD-%EA%B0%80%EB%8A%A5%ED%95%9C-%EC%9D%B8%EB%A0%88%EC%9D%B4-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-%ED%9E%8C%ED%8A%B8\">클릭 가능한 인레이 매개변수 힌트</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A7%80%EC%86%8D%EC%A0%81%EC%9D%B8-%ED%83%80%EC%9E%85-%ED%98%B8%ED%99%98%EC%84%B1-%ED%99%95%EC%9D%B8-%EC%B5%9C%EC%A0%81%ED%99%94\">지속적인 타입 호환성 확인 최적화</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%B3%80%EA%B2%BD-%EC%82%AC%ED%95%AD-%EB%B0%8F-%EC%98%A4%EB%A5%98-%EC%88%98%EC%A0%95\">변경 사항 및 오류 수정</a></p>\n<ul>\n<li><a href=\"#libdts-changes\"><code class=\"language-text\">lib.d.ts Changes</code></a></li>\n<li><a href=\"#labeledelementdeclarations%EC%9D%80-undefined-%EC%9A%94%EC%86%8C%EB%A5%BC-%EB%B3%B4%EC%9C%A0%ED%95%A0-%EC%88%98-%EC%9E%88%EC%9D%8C\"><code class=\"language-text\">labeledElementDeclarations</code>은 <code class=\"language-text\">undefined</code> 요소를 보유할 수 있음</a></li>\n<li><a href=\"#module%EA%B3%BC-moduleresolution%EB%8A%94-%EC%B5%9C%EA%B7%BC-nodejs-%EC%84%A4%EC%A0%95%EC%97%90%EC%84%9C-%EC%9D%BC%EC%B9%98%ED%95%B4%EC%95%BC-%ED%95%9C%EB%8B%A4\"><code class=\"language-text\">module</code>과 <code class=\"language-text\">moduleResolution</code>는 최근 Node.js 설정에서 일치해야 한다.</a></li>\n<li><a href=\"#%EB%B3%91%ED%95%A9%EB%90%9C-%EA%B8%B0%ED%98%B8%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%BC%EA%B4%80%EB%90%9C-export-%ED%99%95%EC%9D%B8\">병합된 기호에 대한 일관된 export 확인</a></li>\n<li><a href=\"#module-%ED%95%AD%EC%83%81-namespace%EB%A1%9C-%EB%B0%A9%EC%B6%9C\"><code class=\"language-text\">module</code> 항상 <code class=\"language-text\">namespace</code>로 방출</a></li>\n</ul>\n</li>\n</ul>"}},"pageContext":{"id":"aa21a89a-22ab-5703-9c9f-707ce6b241e0","frontmatter__slug":"/translate-ts-5-2","previous":null,"previousTitle":null,"next":"/retrospect-one-year","nextTitle":"입사 후 지난 1년간의 기록"}},"staticQueryHashes":["1485575810"],"slicesMap":{}}